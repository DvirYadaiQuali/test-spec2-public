spec_version: 2
workflow: true
description: some workflow

workflow-metadata:
  scope: env_resource
  label-selector: vm
  
inputs:
  input1:
    type: string
    default: 'yaml-default1'
  input2:
    type: string
  agent:
    type: agent
    display-style: normal
    description: "agent name." 

outputs:
  job1_output: '{{ .grains.job1.outputs.print }}'
  job2_output: '{{ .grains.job2.outputs.print }}'
  input1: '{{ .inputs.input1 }}'
  input2: '{{ .inputs.input2 }}'
  
grains:
    job1:
        kind: shell
        spec:
            agent:
                name: '{{ .inputs.agent }}'
            files:
                - source: test-spec2-public
                  path: scripts/print-resource.sh
            activities:
              deploy:
                commands:
                  - name: print
                    command:  './print-resource.sh {{ .bindings.resource_id }} {{ .bindings.grain_path }} {{ .params.token }}'
            outputs:
                - print

    job2:
        kind: shell
        depends-on: job1
        spec:
            agent:
                name: '{{ .inputs.agent }}'
            actvities:
              deploy:
                commands:
                  - command: 'echo hello from job2' 
                  - name: print                  
                    command:  'echo pre-{{ .grains.job1.outputs.print}}-post'
            outputs:
                - print

spec_version: 2
description: Workflow to power off Azure VMs via built-in action

workflow:
  scope: env
  labels-selector: azure_vm
  triggers:
    - type: manual
    - type: cron
      cron: '0 22 * * *' # every day at 22:00
      overridable: true # Allow end-users to override the cron

inputs:
  agent:
    type: agent
    default: vido-review3

  sleep_secs:
    type: string

  regex:
    type: string
    pattern: '^[a-zA-Z]+$'  # regex pattern that prohibits anything other than letters
    validation-description: 'only letters allowed'

grains:
  sleep:
    kind: shell
    spec:
      agent:
        name: '{{.inputs.agent}}'
      activities:
        deploy:
          commands:
            - "sleep {{ .inputs.sleep_secs }}"
